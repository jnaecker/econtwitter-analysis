---
title: "Econtwitter"
author: "Jeffrey Naecker"
date: "5/19/2019"
output: html_document
---

```{r setup, include=F, echo = F, message = F}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```


```{r packages}
library(rtweet)
library(ggplot2)
library(dplyr)
library(ggrepel)
library(knitr)
library(kableExtra)

theme_set(theme_minimal())
```

```{r data}
tweets <- search_tweets("#econtwitter", n = 1000, include_rts = FALSE)
users <- users_data(tweets)
```

Let's look at the number of tweets tagged with #econtwitter each day.

```{r}
tweets %>%
  ts_plot() +
  labs(title = "Tweets tagged with #econtwitter per day", x = "Date", y = "Number of tweets")
```

Who are the most prolific tweeters, as measured by number of tweets in the data set?  Let's also look at their total and average retweets and favorites.

```{r}
users <- 
  tweets %>%
  group_by(screen_name) %>%
  summarize(
    n_tweets         = n(),
    total_likes = sum(favorite_count),
    total_retweets = sum(retweet_count),
    retweet_average  = mean(retweet_count),
    favorite_average = mean(favorite_count)
  ) %>%
  left_join(unique(users))

users %>%
  select(screen_name, n_tweets, total_likes, total_retweets, retweet_average, favorite_average, followers_count) %>%
  arrange(desc(n_tweets)) %>%
  head(10) %>%
  kable() %>%
  kable_styling("hover", full_width = F)
```

Let's look at *average* tweet popularity by user, using retweets and favorites as the two key metrics.

```{r}
users %>%
  mutate(label = if_else(favorite_average >= 60 | retweet_average >= 15, screen_name, "")) %>%
  ggplot(aes(x = favorite_average, y = retweet_average, label = label)) +
  geom_point() +
  geom_text_repel(point.padding = 0.5) +
  stat_smooth(method = "lm")
```

Are there clear "types" in how people use twitter?

```{r}
users %>%
  mutate(
    impact_index = favorite_average + 5*retweet_average,
    label = if_else(impact_index >= 100 | n_tweets >= 8, screen_name, "")
  ) %>%
  ggplot(aes(x = impact_index, y = n_tweets, label = label)) +
  geom_point() +
  geom_text_repel(point.padding = 0.5) 
```


What are the most popular single tweets, as measured by likes? As measured by retweets?

```{r}
# most liked tweets
tweets %>%
  arrange(desc(favorite_count)) %>%
  select(screen_name, favorite_count, text) %>%
  head(10) %>%
  kable() %>%
  kable_styling("hover", full_width = F)


# most retweeted tweets
tweets %>%
  arrange(desc(retweet_count)) %>%
  select(screen_name, retweet_count, text) %>%
  head(10) %>%
  kable() %>%
  kable_styling("hover", full_width = F)
```



